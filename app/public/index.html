<!--/**
* @license
* Copyright 2019-2020 CERN and copyright holders of ALICE O2.
* See http://alice-o2.web.cern.ch/copyright for details of the copyright holders.
* All rights not expressly granted are reserved.
*
* This software is distributed under the terms of the GNU General Public
* License v3 (GPL Version 3), copied verbatim in the file "COPYING".
*
* In applying this license CERN does not waive the privileges and immunities
* granted to it by virtue of its status as an Intergovernmental Organization
* or submit itself to any jurisdiction.
*/
-->




<!doctype html>
<head>
	<title>RCT prototype</title>
	<link rel="stylesheet/less" type="text/css" href="styles/styles.less">
	<script src="scripts/less.js" type="text/javascript"></script>
	<script src="/js/src/compatibility.js"></script>

	<!-- Load the session service, parse variables provided by server in the query -->
	<script type="module">
		import sessionService from '/js/src/sessionService.js';

		sessionService.loadAndHideParameters();

		// TODO it behaves strangely
		// if (localStorage.token !== null && localStorage.token !== undefined) {
		// 	console.log("Try to relog", localStorage.token);
		// 	sessionService.session.token = localStorage.token;
		// }
	</script>

	<script type="module">
		// Import RCT Public Configuration
		import {RCT} from './config.js';
		console.log(RCT);
		window.RCT = RCT;
  	</script>

	<script type="module">
		import {mount} from '/js/src/index.js';
		import view from './view.js';
		import Model from './model/Model.js';
		import {RCT} from './config.js';
		console.log('index html::: RCT (props) : ');
		console.log(RCT);

		const model = new Model();
		const debug = true; // shows when redraw is done
		mount(document.body, view, model, debug);

		window.model = model;
		// mock login
		model.login('rct-user', 'rct-passwd', 'rct-db-v2');

		// TODO
		// if (localStorage.token !== null && localStorage.token !== undefined) {
		// 	model.controlServerRequest();
		// 	model.mode = 'mLogged'
		// 	model.notify();
		// }
	</script>
</head>