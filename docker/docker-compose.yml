version: '3.1'
services:
  application:
    container_name: rct_application
    stdin_open: true
    tty: true 
    build:
      context: ./
      dockerfile: docker/Dockerfile.application
    environment:
      - RUNNING_ENV=DOCKER
    networks:
      - rct-network
    volumes:
      - type: bind
        read_only: true
        source: ./security
        target: /opt/RunConditionTable/security
      - type: bind
        read_only: false
        source: ./database/cache
        target: /opt/RunConditionTable/database/cache
    
  database:
    container_name: rct_database
    build: 
      context: ./
      dockerfile: docker/Dockerfile.database
    environment:
      - RUNNING_ENV=DOCKER
    volumes:
      - type: bind
        read_only: true
        source: ./database
        target: /docker-entrypoint-initdb.d
      - type: bind
        read_only: false
        source: ./database/cache
        target: /postgres/run/database/cache
    networks:
      - rct-network
networks:
  rct-network:
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: "172.200.200.0/24"
          gateway: "172.200.200.1"
      


